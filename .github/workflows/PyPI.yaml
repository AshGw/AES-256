name : PyPI Publish
on :
  push :
    tags :
      - '*'
jobs :
  build-then-publish :
    runs-on : ubuntu-latest
    steps :
      - name : checking out
        uses : actions/checkout@v2
      - name : environment setup
        uses : actions/setup-python@v2
        with :
          python-version : 3.7
      - name : setup
        run  : python -m pip install --upgrade pip 
               pip install wheel twine
      - name : build distro
        run  : python setup.py bdist_wheel sdist
      - name : check distro
        run  : twine check dist/*
      - name : publish
        env :
          TWINE_USERNAME: ${{secrets.TWINE_USERNAME}}
          TWINE_PASSWORD: ${{secrets.TWINE_PASSWORD}}
        run : twine upload dist/*
